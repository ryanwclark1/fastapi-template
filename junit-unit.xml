<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="20" skipped="3" tests="1235" time="128.226" timestamp="2025-12-10T13:32:22.817396-06:00" hostname="woody"><testcase classname="tests.unit.test_app.test_docs" name="test_path_helpers_normalize_and_join" time="0.002" /><testcase classname="tests.unit.test_core.test_search.TestFuzzySearchFilter" name="test_single_field" time="0.002" /><testcase classname="tests.unit.test_app.test_docs" name="test_render_templates_escape_values_and_use_local_assets" time="0.001" /><testcase classname="tests.unit.test_app.test_docs" name="test_configure_documentation_mounts_static_and_skips_docs_when_disabled" time="0.001" /><testcase classname="tests.unit.test_app.test_docs" name="test_ensure_asyncapi_template_patched_is_idempotent" time="0.001" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_app_exception_handler_handles_problem_details[AppException-False]" time="0.003" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_get_task_details" time="0.095" /><testcase classname="tests.unit.test_core.test_search.TestFuzzySearchFilter" name="test_multiple_fields" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestFuzzySearchFilter" name="test_default_threshold" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestFuzzySearchFilter" name="test_word_similarity_option" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentConfig" name="test_default_config" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentConfig" name="test_custom_config" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentConfig" name="test_config_validation" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentState" name="test_default_state" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAITracer" name="test_noop_compensation_span" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_budget_service_initialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_set_and_check_budget" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mixed_list_types" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_performance_with_large_data" time="0.002" /><testcase classname="tests.unit.test_middleware.test_rate_limit" name="test_rate_limit_injects_headers_on_success" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_without_client" time="0.008" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_returns_total_count" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestPhraseProximityFilter" name="test_single_word_fallback" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestPhraseProximityFilter" name="test_multiple_words" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestPhraseProximityFilter" name="test_default_distance_is_adjacent" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentState" name="test_state_to_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestExtractionStrategy" name="test_strategy_values" time="0.002" /><testcase classname="tests.unit.test_features.test_health.test_task_tracker_provider" name="test_query_exception_returns_unhealthy" time="0.006" /><testcase classname="tests.unit.test_features.test_health.test_task_tracker_provider" name="test_metadata_includes_stats" time="0.003" /><testcase classname="tests.unit.test_features.test_email.test_service.TestProviderValidation" name="test_validate_provider_config_aws_ses_missing_fields" time="0.006" /><testcase classname="tests.unit.test_features.test_email.test_service.TestProviderValidation" name="test_validate_provider_config_sendgrid_valid" time="0.004" /><testcase classname="tests.unit.test_features.test_email.test_service.TestProviderValidation" name="test_validate_provider_config_console_no_requirements" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestRetryConfig" name="test_default_values" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestRetryConfig" name="test_custom_values" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_success_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_track_spend" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentState" name="test_state_from_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentResult" name="test_success_result" time="0.001" /><testcase classname="tests.unit.test_middleware.test_rate_limit" name="test_rate_limit_returns_json_when_exceeded" time="0.002" /><testcase classname="tests.unit.test_middleware.test_rate_limit" name="test_rate_limit_fail_open_on_error" time="0.003" /><testcase classname="tests.unit.test_core.test_search.TestPhraseProximityFilter" name="test_whitespace_words_filtered" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestBoostedSearchFilter" name="test_weight_boosts" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestBoostedSearchFilter" name="test_term_boosts" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_cached_with_tags_and_invalidation" time="0.004" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_app_exception_handler_handles_problem_details[RateLimitException-True]" time="0.002" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_validation_exception_handler_formats_errors" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_failure_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_partial_result" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_timeout_result" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentResult" name="test_failure_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestLLMResponse" name="test_response_creation" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_budget_exceeded" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_budget_warning_threshold" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_to_dict" time="0.000" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_generic_exception_handler_tracks_unknown" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestLLMResponse" name="test_response_with_tool_calls" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetConfig" name="test_get_config_found" time="0.089" /><testcase classname="tests.unit.test_middleware.test_rate_limit" name="test_default_key_func_uses_forwarded_header" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_to_message_content_success" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_multiple_functions_sharing_tags" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestBudgetService" name="test_spend_summary" time="0.001" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_allows_request_and_sets_headers" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_running_tasks_empty" time="0.032" /><testcase classname="tests.unit.test_core.test_search.TestHybridSearchFilter" name="test_stores_parameters" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestHybridSearchFilter" name="test_default_weights" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestMultiFieldSearchFilter" name="test_stores_field_configs" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestMultiFieldSearchFilter" name="test_require_all_option" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestRankingOptions" name="test_default_normalization" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_requires_type" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_initialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_with_custom_config" time="0.001" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_problem_json_response_parses_body" time="0.001" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_configure_exception_handlers_registers_handlers" time="0.017" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_cache_key_consistency_across_calls" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolResult" name="test_to_message_content_failure" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_with_default_config" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketEndpoint" name="test_websocket_disabled_closes_connection" time="0.006" /><testcase classname="tests.unit.test_core.test_search.TestRankingOptions" name="test_cover_density_option" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestRankingOptions" name="test_custom_weights" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestRankNormalization" name="test_can_combine_flags" time="0.000" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_returns_json_when_rate_limit_exceeded" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_tool_requires_name" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_tool_requires_description" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_tool_definition_generation" time="0.002" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketEndpoint" name="test_websocket_manager_not_initialized" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestObservabilityIntegration" name="test_all_components_importable" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestRankNormalization" name="test_none_is_zero" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_state_property" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_simple_query" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_openai_format" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestObservabilityIntegration" name="test_singleton_getters" time="0.001" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_fail_open_when_limiter_errors" time="0.003" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_quoted_phrase" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_execute_tool" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_field_term" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_invalidate_pattern_clears_related_caches" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_anthropic_format" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_field_phrase" time="0.001" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_default_key_function_uses_forwarded_header" time="0.003" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketEndpoint" name="test_websocket_connection_refused" time="0.008" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_exclusion" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_execute_missing_tool" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBasicExecution" name="test_execute_returns_result" time="0.008" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_prefix" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_tool_validate_input" time="0.005" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_middleware_skips_when_disabled" time="0.002" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_conditional_caching_with_empty_results" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_parse_fuzzy" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_agent_cancel" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_empty_query" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestBaseTool" name="test_tool_callable" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestBaseAgent" name="test_simple_agent_execute" time="0.001" /><testcase classname="tests.unit.test_middleware.test_rate_limit_middleware" name="test_middleware_skips_exempt_paths" time="0.002" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_has_fts_query_true" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_has_field_filters" time="0.000" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestGetStats" name="test_get_stats_success" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestFunctionTool" name="test_tool_decorator" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_generates_request_id_when_not_provided" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestSearchQueryParser" name="test_has_exclusions" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestQueryRewriter" name="test_expand_synonyms" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentToolExecution" name="test_execute_tools_formats_results" time="0.002" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_not_found_error_handler" time="0.002" /><testcase classname="tests.unit.test_core.test_search.TestQueryRewriter" name="test_remove_stop_words" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheIntegration" name="test_skip_cache_forces_fresh_data" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestFunctionTool" name="test_tool_decorator_default_name" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_base.TestAgentToolExecution" name="test_execute_tools_handles_errors" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBasicExecution" name="test_execute_calls_saga_coordinator" time="0.007" /><testcase classname="tests.unit.test_core.test_search.TestQueryRewriter" name="test_normalize_whitespace" time="0.000" /><testcase classname="tests.unit.test_app.test_exception_handlers" name="test_pydantic_validation_exception_handler" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestFunctionTool" name="test_tool_decorator_returns_toolresult" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestMemoryMessage" name="test_create_basic_message" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestQueryRewriter" name="test_min_word_length" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_build_search_vector_sql" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_preserves_existing_request_id" time="0.005" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_cache_key_with_empty_args" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestMemoryMessage" name="test_message_to_dict" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestMemoryMessage" name="test_message_to_dict_with_tool_calls" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestFunctionTool" name="test_tool_decorator_handles_exceptions" time="0.002" /><testcase classname="tests.unit.test_app.test_lifespan" name="test_lifespan_runs_with_all_dependencies_disabled" time="0.002"><failure message="AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'">.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:92: in annotated_getattr
    obj = getattr(obj, name)
          ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'start_broker'

The above exception was the direct cause of the following exception:
tests/unit/test_app/test_lifespan.py:79: in test_lifespan_runs_with_all_dependencies_disabled
    _patch_common_dependencies(monkeypatch)
tests/unit/test_app/test_lifespan.py:394: in _patch_common_dependencies
    monkeypatch.setattr(
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:106: in derive_importpath
    annotated_getattr(target, attr, ann=module)
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:94: in annotated_getattr
    raise AttributeError(
E   AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'</failure></testcase><testcase classname="tests.unit.test_features.test_realtime.test_router.TestGetStats" name="test_get_stats_manager_not_initialized" time="0.007" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_build_search_vector_sql_with_prefix" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_get_search_trigger_sql" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestMemoryMessage" name="test_message_from_dict" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_register_tool" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_task_stats_with_hours" time="0.027" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBasicExecution" name="test_execute_without_tenant" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestMemoryMessage" name="test_message_hash" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_add_message" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_register_duplicate_raises" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_get_backfill_sql" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_get_drop_trigger_sql" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_request_id_in_response_header" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_empty_search_fields" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_add_message_object" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_max_messages_limit" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_get_tool" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_get_field_config" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_cached_with_no_args_function" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_add_messages_batch" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestSearchableMixin" name="test_get_field_weight" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_get_messages" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_get_required_tool" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestBroadcast" name="test_broadcast_success" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_unregister_tool" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBudgetIntegration" name="test_execute_checks_budget" time="0.008" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_sets_logging_context" time="0.005" /><testcase classname="tests.unit.test_core.test_search.TestMultiLanguageSearchMixin" name="test_get_search_trigger_sql_multilang" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestFTSMigrationHelper" name="test_default_names" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_list_tools" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_get_memory_messages" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_clear" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_token_tracking" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestFTSMigrationHelper" name="test_custom_names" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestBufferMemory" name="test_serialize_deserialize" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestWindowMemory" name="test_sliding_window" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_invalidate_cache_with_no_suffix" time="0.004" /><testcase classname="tests.unit.test_core.test_search.TestFTSMigrationHelper" name="test_get_trigger_function_sql" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestFTSMigrationHelper" name="test_get_backfill_sql" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_clears_logging_context_after_request" time="0.005" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_cached_decorator_with_exception" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestWindowMemory" name="test_keep_system_messages" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestTrigramMigrationHelper" name="test_default_index_name" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_list_by_tag" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_get_definitions" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_get_openai_tools" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestBroadcast" name="test_broadcast_manager_not_initialized" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestWindowMemory" name="test_no_duplicate_system_messages" time="0.000" /><testcase classname="tests.unit.test_core.test_search.TestTrigramMigrationHelper" name="test_get_index_sql" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_get_anthropic_tools" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestUnaccentMigrationHelper" name="test_get_config_sql" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestWindowMemory" name="test_clear_conversation" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestWindowMemory" name="test_serialize_deserialize" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_recent_messages" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_cache_key_with_nested_dict" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestGenerateSearchVectorSQL" name="test_basic_generation" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_global_registry" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_overflow_to_pending" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBudgetIntegration" name="test_execute_skips_budget_when_no_tenant" time="0.010" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_tools.TestToolRegistry" name="test_clear_registry" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_clears_context_on_error" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_set_summary" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheEdgeCases" name="test_tags_with_multiple_values" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_system_messages_preserved" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_summarize_pending" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_request_id_available_in_scope_state" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestSummaryMemory" name="test_serialize_deserialize" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestGenerateSearchVectorSQL" name="test_with_prefix" time="0.001" /><testcase classname="tests.unit.test_core.test_search.TestGenerateSearchVectorSQL" name="test_empty_fields" time="0.001" /><testcase classname="tests.unit.test_core.test_services" name="test_health_service_check_health" time="0.240" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_handles_non_http_scope" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestNodeStatus" name="test_status_values" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowStatus" name="test_status_values" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestHumanApprovalRequest" name="test_create_request" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestBroadcast" name="test_broadcast_invalid_request" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestHumanApprovalRequest" name="test_default_options" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestConversationMemory" name="test_short_term_buffer" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_handles_missing_headers" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerInitialization" name="test_initialization_with_defaults" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestNodeResult" name="test_successful_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestNodeResult" name="test_failed_result" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestConversationMemory" name="test_overflow_to_long_term" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_ping_message" time="0.002" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_subscribe_message" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerInitialization" name="test_initialization_with_custom_values" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBudgetIntegration" name="test_execute_skips_budget_when_requested" time="0.012" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestNodeResult" name="test_duration_calculation" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_case_insensitive_header_handling" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestConversationMemory" name="test_combined_messages" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestConversationMemory" name="test_clear_short_term_only" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestNodeResult" name="test_duration_without_times" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestConversationMemory" name="test_serialize_deserialize" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_multiple_requests_have_different_ids" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_task_details_found" time="0.033" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerInitialization" name="test_initialization_validates_thresholds" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowState" name="test_create_state" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_unsubscribe_message" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestCreateMemory" name="test_create_buffer_memory" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateProperties" name="test_is_closed_property" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_id.TestRequestIDMiddleware" name="test_performance_with_pure_asgi" time="0.046" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_message_forwarding" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestCreateMemory" name="test_create_window_memory" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestCreateMemory" name="test_create_summary_memory" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowState" name="test_state_serialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestCreateMemory" name="test_create_conversation_memory" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_get_stats_aggregates_queries" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestFunctionNode" name="test_execute_success" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestFunctionNode" name="test_execute_failure" time="0.001" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_invalid_json" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_memory.TestCreateMemory" name="test_invalid_memory_type" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateProperties" name="test_is_open_property" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_create_state_key" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBudgetIntegration" name="test_execute_raises_on_budget_exceeded" time="0.010" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestFunctionNode" name="test_execute_with_retry" time="0.002" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_unknown_message_type" time="0.002" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_cancel_task_behaviour" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_str" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_to_redis_key" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateProperties" name="test_is_half_open_property" time="0.003" /><testcase classname="tests.unit.test_features.test_realtime.test_router.TestWebSocketMessageHandling" name="test_handle_message_exception" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_to_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestHumanApprovalNode" name="test_execute_creates_request" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_from_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_connect_and_disconnect" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_from_string" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_from_string_default_version" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestHumanApprovalNode" name="test_approval_handler_called" time="0.003" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetConfig" name="test_get_config_not_found" time="0.005" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_on_task_start_records_execution" time="0.002" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_on_task_finish_updates_status_and_indices" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateTransitions" name="test_closed_to_open_on_failures" time="0.004" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateTransitions" name="test_open_to_half_open_after_timeout" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConditionalNode" name="test_execute_routes_correctly" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestBudgetIntegration" name="test_execute_tracks_spend_after_success" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateKey" name="test_state_key_from_string_invalid" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_create_entry" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_simple_daily_rule" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_weekly_with_interval" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_weekly_with_weekdays" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_get_running_tasks_reports_elapsed" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConditionalNode" name="test_execute_with_async_condition" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateTransitions" name="test_half_open_to_closed_on_successes" time="0.002" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetConfig" name="test_get_config_or_raise_found" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_entry_not_expired" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_entry_expired" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_monthly_with_day" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConditionalNode" name="test_execute_uses_default_branch" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_entry_not_yet_expired" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestMetricsIntegration" name="test_execute_records_pipeline_started" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_entry_to_dict" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetConfig" name="test_get_config_or_raise_not_found" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_task_details_not_found" time="0.032" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerStateTransitions" name="test_half_open_to_open_on_failure" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestStateEntry" name="test_entry_from_dict" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_rule_with_count" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_rule_with_until" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_from_rrule_string_simple" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_from_rrule_string_complex" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerCallProtection" name="test_call_succeeds_when_closed" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestParallelNode" name="test_execute_parallel_branches" time="0.002" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_get_task_history_filters_and_paginates" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestMetricsIntegration" name="test_execute_records_pipeline_completed" time="0.010" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestParallelNode" name="test_missing_branch_fails" time="0.002" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCreateOrUpdateConfig" name="test_create_new_config" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_set_and_get" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerCallProtection" name="test_call_raises_circuit_open_error_when_open" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_get_missing_key" time="0.002" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_get_task_details_parses_fields" time="0.004" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerCallProtection" name="test_call_records_failures" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_run_simple_workflow" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestRecurrenceRule" name="test_roundtrip" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_set_with_ttl" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerCallProtection" name="test_call_resets_failure_count_on_success" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_daily_occurrences" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_run_workflow_failure" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_expired_value_not_returned" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_get_stats_aggregates_counts" time="0.004" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCreateOrUpdateConfig" name="test_update_existing_config" time="0.009" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_delete" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerCallProtection" name="test_call_with_unexpected_exception" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerDecoratorPattern" name="test_protected_decorator_success" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_run_workflow_with_conditional" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_weekly_occurrences" time="0.003" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_weekdays_occurrences" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_delete_missing" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_workflow_pauses_for_approval" time="0.003" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_occurrences_with_after" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_exists" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestMetricsIntegration" name="test_execute_records_pipeline_execution_metrics" time="0.014" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerDecoratorPattern" name="test_protected_decorator_failure" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_exists_expired" time="0.002" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCreateOrUpdateConfig" name="test_create_config_validation_error" time="0.006" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_cancel_task_handles_status" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_occurrences_with_before" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_list_keys" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_submit_approval_continues" time="0.003" /><testcase classname="tests.unit.test_infra.test_tracking.test_redis_tracker" name="test_returns_empty_when_not_connected" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_masks_common_pii_fields_and_strings" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_trigger_task_success" time="0.026" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflow" name="test_submit_rejection_fails" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_biweekly_occurrences" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerDecoratorPattern" name="test_protected_decorator_preserves_metadata" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_clear_namespace" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_get_or_set" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_creates_span_with_correct_name" time="0.004" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_truncates_on_max_depth_and_custom_pattern" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_masks_email_preserve_domain" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_masks_email_no_preserve_domain" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerDecoratorPattern" name="test_call_decorator_alias" time="0.004" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_masks_phone_preserve_last_4" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_get_or_set_async_factory" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGenerateOccurrences" name="test_exclude_start" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestUpdateConfig" name="test_update_config_success" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_increment" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowBuilder" name="test_build_simple_workflow" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowBuilder" name="test_build_with_edges" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowBuilder" name="test_build_missing_entry_point" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestMetricsIntegration" name="test_execute_records_budget_exceeded_metric" time="0.010" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerContextManager" name="test_context_manager_success" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowBuilder" name="test_build_invalid_entry_point" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging" name="test_masker_masks_credit_card" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestInMemoryStateStore" name="test_clear_all" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestWorkflowBuilder" name="test_build_invalid_edge" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGetNextOccurrence" name="test_next_daily" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestGetNextOccurrence" name="test_next_weekly" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestValidateRrule" name="test_valid_rrule" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestValidateRrule" name="test_invalid_frequency" time="0.000" /><testcase classname="tests.unit.test_features.test_email.test_service.TestUpdateConfig" name="test_update_config_not_found" time="0.006" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestValidateRrule" name="test_missing_freq" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerContextManager" name="test_context_manager_failure" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_request" time="0.012" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_set_and_get" time="0.002" /><testcase classname="tests.unit.test_app.test_lifespan" name="test_lifespan_initializes_database_and_cache" time="0.002"><failure message="AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'">.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:92: in annotated_getattr
    obj = getattr(obj, name)
          ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'start_broker'

The above exception was the direct cause of the following exception:
tests/unit/test_app/test_lifespan.py:111: in test_lifespan_initializes_database_and_cache
    _patch_common_dependencies(monkeypatch)
tests/unit/test_app/test_lifespan.py:394: in _patch_common_dependencies
    monkeypatch.setattr(
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:106: in derive_importpath
    annotated_getattr(target, attr, ann=module)
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:94: in annotated_getattr
    raise AttributeError(
E   AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'</failure></testcase><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestTracingIntegration" name="test_execute_creates_pipeline_span" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_uses_default_ttl" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_daily" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_weekly" time="0.000" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_weekly_with_days" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_with_interval" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConvenienceFunctions" name="test_human_approval_factory" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConvenienceFunctions" name="test_conditional_branch_factory" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_workflows.TestConvenienceFunctions" name="test_parallel_branches_factory" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestDeleteConfig" name="test_delete_config_success" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_custom_ttl_overrides_default" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerContextManager" name="test_context_manager_raises_when_open" time="0.002" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_monthly" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_register_provider_adds_to_registry" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerContextManager" name="test_context_manager_half_open_call_limit" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_register_provider_updates_capability_index" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestDescribeRrule" name="test_describe_invalid" time="0.000" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_daily_preset" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_delete" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerMetrics" name="test_get_metrics_initial_state" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_sets_span_attributes_from_event" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_register_provider_with_factory" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_exists" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_weekly_preset" time="0.000" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_records_success_status" time="0.003" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_records_exception_on_failure" time="0.005" /><testcase classname="tests.unit.test_features.test_email.test_service.TestDeleteConfig" name="test_delete_config_not_found" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_register_duplicate_updates_existing" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestTracingIntegration" name="test_execute_records_success_on_span" time="0.008" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_custom_handler_name" time="0.003" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_handles_missing_event_fields" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerMetrics" name="test_get_metrics_tracks_operations" time="0.004" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerMetrics" name="test_get_metrics_failure_rate_calculation" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_list_keys" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_list_keys_with_pattern" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_unregister_provider_removes_from_registry" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_weekdays_preset" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderRegistration" name="test_unregister_nonexistent_returns_false" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_returns_sorted_by_priority" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_biweekly_preset" time="0.001" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_monthly_preset" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestTestConfig" name="test_test_config_success" time="0.009" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_clear" time="0.005" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_span_ends_even_on_exception" time="0.005" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_exempts_health_path" time="0.019" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_trigger_task_broker_unavailable" time="0.033" /><testcase classname="tests.unit.test_features.test_reminders.test_recurrence.TestPresets" name="test_yearly_preset" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestTracingIntegration" name="test_execute_records_failure_on_span" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_filters_by_quality_tier" time="0.004" /><testcase classname="tests.unit.test_app.test_lifespan" name="test_lifespan_starts_and_stops_service_discovery" time="0.003"><failure message="AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'">.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:92: in annotated_getattr
    obj = getattr(obj, name)
          ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'start_broker'

The above exception was the direct cause of the following exception:
tests/unit/test_app/test_lifespan.py:176: in test_lifespan_starts_and_stops_service_discovery
    _patch_common_dependencies(
tests/unit/test_app/test_lifespan.py:394: in _patch_common_dependencies
    monkeypatch.setattr(
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:106: in derive_importpath
    annotated_getattr(target, attr, ann=module)
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:94: in annotated_getattr
    raise AttributeError(
E   AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'</failure></testcase><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerMetrics" name="test_get_stats_backward_compatibility" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_excludes_specified" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestTracedHandler" name="test_preserves_function_name_and_docstring" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestScopedStateStore" name="test_versioned_keys" time="0.002" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestExtractEvent" name="test_extracts_from_first_positional_arg" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_excludes_unavailable" time="0.001" /><testcase classname="tests.unit.test_features.test_search_cache" name="test_search_cache_set_and_get_results" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestGlobalStateStore" name="test_get_default_store" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerReset" name="test_reset_clears_state" time="0.002" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestExtractEvent" name="test_extracts_from_event_kwarg" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestTracingIntegration" name="test_execute_works_without_tracer" time="0.008" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestExtractEvent" name="test_extracts_from_message_kwarg" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestGlobalStateStore" name="test_get_same_store" time="0.001" /><testcase classname="tests.unit.test_features.test_search_cache" name="test_search_cache_respects_max_query_length" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_includes_unavailable_when_requested" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCapabilityDiscovery" name="test_get_providers_returns_empty_for_unknown_capability" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestGlobalStateStore" name="test_configure_store" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerReset" name="test_reset_allows_immediate_calls" time="0.002" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestExtractEvent" name="test_returns_none_for_plain_args" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_state_store.TestGlobalStateStore" name="test_reset_store" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestExtractEvent" name="test_extracts_from_any_kwarg_with_event_id" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_extracts_client_ip_from_forwarded_for" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCheapestProvider" name="test_get_cheapest_finds_lowest_cost" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestSpanHelpers" name="test_add_message_span_attributes" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerConcurrency" name="test_concurrent_calls_thread_safe" time="0.002" /><testcase classname="tests.unit.test_features.test_search_cache" name="test_suggestions_cache_and_stats" time="0.003" /><testcase classname="tests.unit.test_features.test_email.test_service.TestTestConfig" name="test_test_config_failure" time="0.011" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestSpanHelpers" name="test_add_message_span_attributes_skips_non_recording" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestExtractionResult" name="test_successful_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestExtractionResult" name="test_failed_result" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCheapestProvider" name="test_get_cheapest_respects_quality_filter" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerConcurrency" name="test_concurrent_failures_counted_correctly" time="0.002" /><testcase classname="tests.unit.test_features.test_search_cache" name="test_invalidation_helpers" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestExtractionResult" name="test_result_with_cost_tracking" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCheapestProvider" name="test_get_cheapest_excludes_providers" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestSpanHelpers" name="test_add_message_span_event" time="0.001" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestSpanHelpers" name="test_add_message_span_event_without_attributes" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCheapestProvider" name="test_get_cheapest_returns_none_when_no_providers" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_extracts_client_ip_from_real_ip" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_get_json_schema" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerHalfOpenState" name="test_half_open_limits_concurrent_calls" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestErrorHandling" name="test_failed_execution_returns_result" time="0.010" /><testcase classname="tests.unit.test_messaging.test_tracing_utilities.TestSpanHelpers" name="test_add_message_span_event_skips_non_recording" time="0.001" /><testcase classname="tests.unit.test_features.test_search_cache" name="test_global_cache_init" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_get_function_schema" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestTestConfig" name="test_test_config_exception" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestFallbackChain" name="test_build_chain_starts_with_primary" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerHalfOpenState" name="test_half_open_success_progression" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestFallbackChain" name="test_build_chain_uses_priority_without_primary" time="0.002" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_generates_correlation_id_when_not_provided" time="0.010" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_get_system_prompt" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_initial_state_closed" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_masks_sensitive_headers" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_valid_json" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestFallbackChain" name="test_build_chain_respects_max_fallbacks" time="0.002" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerEdgeCases" name="test_recovery_timeout_edge_case" time="0.002" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_can_execute_when_closed" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestFallbackChain" name="test_build_chain_excludes_providers" time="0.005" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerEdgeCases" name="test_zero_failure_rate_with_no_calls" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_markdown_json" time="0.002" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_opens_after_threshold_failures" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_trigger_task_invalid_name" time="0.026" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_success_resets_failure_count_in_half_open" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerEdgeCases" name="test_exception_in_decorator_propagates" time="0.002" /><testcase classname="tests.unit.test_app.test_lifespan" name="test_lifespan_warns_when_database_optional" time="0.002"><failure message="AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'">.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:92: in annotated_getattr
    obj = getattr(obj, name)
          ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'start_broker'

The above exception was the direct cause of the following exception:
tests/unit/test_app/test_lifespan.py:220: in test_lifespan_warns_when_database_optional
    _patch_common_dependencies(monkeypatch)
tests/unit/test_app/test_lifespan.py:394: in _patch_common_dependencies
    monkeypatch.setattr(
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:106: in derive_importpath
    annotated_getattr(target, attr, ann=module)
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:94: in annotated_getattr
    raise AttributeError(
E   AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'</failure></testcase><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_inline_json" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCheckHealth" name="test_check_health_success" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestErrorHandling" name="test_metrics_recorded_on_failure" time="0.010" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_request_body_when_enabled" time="0.006" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_preserves_existing_correlation_id" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_invalid_json" time="0.001" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerIntegration" name="test_full_circuit_lifecycle" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_validation_error" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_failure_in_half_open_reopens" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestFallbackChain" name="test_build_chain_skips_unavailable_primary" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_function_call_dict" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_correlation_id_in_response_header" time="0.003" /><testcase classname="tests.unit.test_infra.test_circuit_breaker.TestCircuitBreakerIntegration" name="test_realistic_service_degradation_scenario" time="0.003" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_reset" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_function_call_string" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestAdapterCreation" name="test_create_adapter_calls_factory" time="0.002" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_preserves_upstream_correlation_id_in_response" time="0.004" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCheckHealth" name="test_check_health_unhealthy" time="0.005" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_does_not_log_body_when_disabled" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestErrorHandling" name="test_pipeline_completed_always_recorded" time="0.008" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_with_optional_field" time="0.002" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreaker" name="test_get_stats" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestAdapterCreation" name="test_create_adapter_raises_for_unknown_provider" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestAdapterCreation" name="test_create_adapter_raises_without_factory" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreakerRegistry" name="test_get_or_create" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputParser" name="test_parse_with_missing_optional" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestCircuitBreakerRegistry" name="test_get_all_stats" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestCheckHealth" name="test_check_health_exception" time="0.004" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_informational_question" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestConfiguration" name="test_default_configuration" time="0.002" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_navigational_single_term" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_transactional_action" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_detects_security_events" time="0.005" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetUsageStats" name="test_get_usage_stats" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputExtractor" name="test_extract_success" time="0.002" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_correlation_id_available_in_request_state" time="0.004" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_exploratory_browse" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCostEstimation" name="test_estimate_cost_for_transcription" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCostEstimation" name="test_estimate_cost_for_llm" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_empty_query" time="0.000" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_get_correlation_id_from_request_helper" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestCostEstimation" name="test_estimate_cost_returns_none_for_unknown" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputExtractor" name="test_extract_with_retry" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderAvailability" name="test_mark_unavailable_sets_flag" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_suggested_adjustments" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestIntentClassifier" name="test_classify_query_intent_convenience" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputExtractor" name="test_extract_max_retries_exceeded" time="0.003" /><testcase classname="tests.unit.test_app.test_lifespan" name="test_lifespan_raises_when_database_required" time="0.002"><failure message="AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'">.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:92: in annotated_getattr
    obj = getattr(obj, name)
          ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'start_broker'

The above exception was the direct cause of the following exception:
tests/unit/test_app/test_lifespan.py:249: in test_lifespan_raises_when_database_required
    _patch_common_dependencies(monkeypatch)
tests/unit/test_app/test_lifespan.py:394: in _patch_common_dependencies
    monkeypatch.setattr(
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:106: in derive_importpath
    annotated_getattr(target, attr, ann=module)
.venv/lib/python3.13/site-packages/_pytest/monkeypatch.py:94: in annotated_getattr
    raise AttributeError(
E   AttributeError: 'NoneType' object at example_service.infra.messaging.broker has no attribute 'start_broker'</failure></testcase><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_cancel_task_success" time="0.027" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetUsageStats" name="test_get_usage_stats_with_date_range" time="0.005" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestSearchConfiguration" name="test_default_configuration" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestConfiguration" name="test_api_keys_configuration" time="0.006" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_handles_non_http_scope" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderAvailability" name="test_mark_available_sets_flag" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_user_context" time="0.011" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderAvailability" name="test_is_capability_available_true_when_provider_exists" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestConfiguration" name="test_model_overrides_configuration" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestStructuredOutputExtractor" name="test_extract_with_function_calling" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestProviderAvailability" name="test_is_capability_available_false_when_all_unavailable" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestSearchConfiguration" name="test_entity_registry" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestSearchConfiguration" name="test_get_enabled_features" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestSingleton" name="test_get_registry_returns_same_instance" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetAuditLogs" name="test_get_audit_logs_offset_based" time="0.005" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestSearchSettings" name="test_default_values" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestSingleton" name="test_reset_creates_new_instance" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_case_insensitive_header_handling" time="0.008" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestSearchSettings" name="test_custom_values" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestIntrospection" name="test_get_all_providers" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestEventStreaming" name="test_stream_events_returns_async_iterator" time="0.006" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestExtractStructured" name="test_simple_extraction" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_exception" time="0.006" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetAuditLogs" name="test_get_audit_logs_cursor_based" time="0.005" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestIntrospection" name="test_get_all_capabilities" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestRankingConfig" name="test_default_config" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestRankingConfig" name="test_calculate_final_rank_no_boost" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestIntrospection" name="test_get_capability_metadata" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestValidateOutput" name="test_validate_dict_output" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestRankingConfig" name="test_calculate_final_rank_with_boost" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestRankingConfig" name="test_calculate_final_rank_with_entity_boost" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_capability_registry.TestIntrospection" name="test_get_capability_metadata_returns_none_for_missing" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_orchestrator.TestEventStreaming" name="test_stream_events_filters_by_type" time="0.004" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_multiple_requests_have_different_correlation_ids" time="0.009" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestClickSignal" name="test_click_boost_calculation" time="0.001" /><testcase classname="tests.unit.test_features.test_search_enhancements.TestClickSignal" name="test_no_clicks_no_boost" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_slow_requests" time="0.108" /><testcase classname="tests.unit.test_features.test_email.test_service.TestSendEmail" name="test_send_email_success" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_logger_initialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_pipeline_started_logging" time="0.001" /><testcase classname="tests.unit.test_features.test_search_service" name="test_get_capabilities_lists_entities" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_requires_capability" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_with_capability" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_description" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_pipeline_completed_logging" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_provider_preference" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestSendEmail" name="test_send_email_config_not_found" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestValidateOutput" name="test_validate_model_output" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestValidateOutput" name="test_validate_string_output" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_quality_tier" time="0.001" /><testcase classname="tests.unit.test_features.test_search_service" name="test_get_cache_respects_flags" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_pipeline_failed_logging" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_step_logging" time="0.001" /><testcase classname="tests.unit.test_features.test_search_service_integration" name="test_search_uses_cache_and_sets_results" time="0.086" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_cancel_task_not_cancellable" time="0.024" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_custom_header_name" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_options" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_input_output" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_provider_logging" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestSendEmail" name="test_send_email_config_disabled" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_input_transform" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestValidateOutput" name="test_validate_invalid_string_raises" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_budget_logging" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestValidateOutput" name="test_validate_wrong_type_raises" time="0.002" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_generate_if_missing_false" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_timed_operation_context_manager" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIObservabilityLogger" name="test_log_context_to_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_output_transform" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_timeout" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_default_timeout" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestCreateResponseModel" name="test_create_simple_model" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_metrics_initialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepBuilder" name="test_step_progress_weight" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepConditions" name="test_when_with_function" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_correlation_id_with_error_response" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_metrics_disabled" time="0.001" /><testcase classname="tests.unit.test_features.test_email.test_service.TestSendEmail" name="test_send_email_provider_failure" time="0.007" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestCreateResponseModel" name="test_create_model_with_defaults" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepConditions" name="test_when_exists" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepConditions" name="test_when_equals" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_pipeline_execution" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_distributed_tracing_scenario" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepOptional" name="test_step_is_required_by_default" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_provider_request" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepOptional" name="test_step_optional" time="0.000" /><testcase classname="tests.unit.test_features.test_email.test_service.TestSendEmail" name="test_send_email_exception" time="0.004" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepOptional" name="test_step_continue_on_failure" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_provider_timeout" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepFallback" name="test_fallback_enabled_by_default" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepFallback" name="test_with_fallback_configuration" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepFallback" name="test_no_fallback" time="0.000" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_concurrent_requests_maintain_isolation" time="0.018" /><testcase classname="tests.unit.test_features.test_email.test_service.TestGetAvailableProviders" name="test_get_available_providers" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_budget_metrics" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_sli_metrics" time="0.001" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_flag_repository_initialization" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepRetry" name="test_default_retry_policy" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepRetry" name="test_with_retry_configuration" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepRetry" name="test_no_retry" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepCompensation" name="test_no_compensation_by_default" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAIMetrics" name="test_record_fallback_metrics" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_list_scheduled_jobs" time="0.023" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_feature_flag_repository_returns_singleton" time="0.001" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_flag_override_repository_returns_singleton" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepCompensation" name="test_compensate_with" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAITracer" name="test_tracer_initialization_disabled" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAITracer" name="test_noop_pipeline_span" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_requires_steps" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_basic_build" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_version" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAITracer" name="test_noop_step_span" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_description" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_tags" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_correlation_id_format_validation" time="0.012" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_timeout" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_default_timeout" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_max_concurrent" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_no_fail_fast" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineBuilder" name="test_pipeline_fail_fast_by_default" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineCompensation" name="test_compensation_enabled_by_default" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineCompensation" name="test_with_compensation" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineCompensation" name="test_no_compensation" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineEstimates" name="test_estimated_duration" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineEstimates" name="test_estimated_cost" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineEstimates" name="test_estimated_cost_from_float" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineCheckpoints" name="test_no_checkpoints_by_default" time="0.000" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_empty_correlation_id_header" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineCheckpoints" name="test_checkpoint" time="0.001" /><testcase classname="tests.unit.test_core.test_services" name="test_health_service_readiness" time="0.002"><failure message="ImportError: cannot import name 'record_health_check_result' from 'example_service.features.health.providers' (/home/administrator/Code/fastapi-template/example_service/features/health/providers/__init__.py)">tests/unit/test_core/test_services.py:36: in test_health_service_readiness
    result = await service.readiness()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/core/services/health.py:371: in readiness
    result = await aggregator.check_provider(name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/health/aggregator.py:442: in check_provider
    from example_service.features.health.providers import (
E   ImportError: cannot import name 'record_health_check_result' from 'example_service.features.health.providers' (/home/administrator/Code/fastapi-template/example_service/features/health/providers/__init__.py)</failure></testcase><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineStepAddition" name="test_add_prebuilt_step" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_list_scheduled_jobs_empty" time="0.027" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineStepAddition" name="test_add_multiple_prebuilt_steps" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestPipelineStepAddition" name="test_mixed_step_addition" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestComplexPipeline" name="test_call_analysis_pipeline" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepDone" name="test_done_returns_pipeline_builder" time="0.001" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDMiddleware" name="test_performance_with_pure_asgi" time="0.145" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestStepDone" name="test_done_fails_without_parent" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestConvenienceFunctions" name="test_pipeline_function_creates_builder" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestConvenienceFunctions" name="test_step_function_creates_builder" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_pipeline_builder.TestConvenienceFunctions" name="test_step_function_is_standalone" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_simple_string" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_integer" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_float" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_boolean" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_multiple_args" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_kwargs" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_args_and_kwargs" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_scheduled_job_found" time="0.020" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_orm_model" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_dict" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_dict_order_independence" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_list" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_consistent_hashing" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_none_kwarg" time="0.000" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCacheKeyFunction" name="test_cache_key_with_model_in_kwargs" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_basic_cache_miss_then_hit" time="0.004" /><testcase classname="tests.unit.test_features.test_search_service_integration" name="test_search_records_analytics_and_handles_low_hits" time="0.004" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_default_key_prefix" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_custom_key_builder" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_structured_output.TestCreateResponseModel" name="test_create_model_with_description" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_observability.TestAITracer" name="test_noop_provider_span" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_scheduled_job_not_found" time="0.022" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_ttl_zero" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_ttl_custom" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_skip_cache_true" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_respects_max_body_size" time="0.007" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_skip_cache_false" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_malformed_json_body" time="0.007" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_condition_true" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_condition_false" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_tags" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_response_body_when_enabled" time="0.008" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_with_multiple_args" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_pause_scheduled_job_success" time="0.026" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestCachedDecorator" name="test_cached_preserves_function_metadata" time="0.001" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_create_bucket_success" time="0.039" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_empty_request_body" time="0.006" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateCache" name="test_invalidate_cache_existing_key" time="0.002" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateCache" name="test_invalidate_cache_missing_key" time="0.005" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_non_json_body" time="0.007" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateCache" name="test_invalidate_cache_with_kwargs" time="0.002" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateCache" name="test_invalidate_cache_with_complex_args" time="0.003" /><testcase classname="tests.unit.test_core.test_services" name="test_health_service_liveness" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_detects_xss_attempts" time="0.012" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_from_user_extracts_tenant" time="0.008" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidatePattern" name="test_invalidate_pattern_with_matches" time="0.010" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_pause_scheduled_job_not_found" time="0.027" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_from_user_returns_none_without_tenant_info" time="0.001" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_sets_middleware_context_var" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidatePattern" name="test_invalidate_pattern_with_string_keys" time="0.003" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_header_fallback_sets_middleware_context" time="0.001" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_jwt_takes_priority_over_header" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_detects_path_traversal" time="0.007" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantDependencyBridge" name="test_get_tenant_context_no_context_does_not_set_middleware_var" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidatePattern" name="test_invalidate_pattern_no_matches" time="0.003" /><testcase classname="tests.unit.test_core.test_tenant_dependency.TestTenantAwareSessionIntegration" name="test_tenant_aware_session_reads_bridged_context" time="0.001" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidatePattern" name="test_invalidate_pattern_complex_pattern" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_custom_exempt_paths" time="0.005" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidatePattern" name="test_invalidate_pattern_without_client" time="0.002" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_delete_bucket_success" time="0.040" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_single_tag" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_resume_scheduled_job_success" time="0.018" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_custom_sensitive_fields" time="0.007" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_multiple_tags" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_removes_tag_sets" time="0.003" /><testcase classname="tests.unit.test_infra.test_cache.test_decorators.TestInvalidateTags" name="test_invalidate_tags_empty_tag_set" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_streaming_response" time="0.007" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestListPipelines" name="test_list_pipelines_success" time="0.025" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_extracts_user_agent" time="0.006" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_resume_scheduled_job_not_found" time="0.018" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskStatus" name="test_all_statuses_exist" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskStatus" name="test_status_values" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_request_size" time="0.007" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_backup_tasks" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_notification_tasks" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_cache_tasks" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_export_tasks" time="0.000" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDIntegration" name="test_correlation_id_with_request_id" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_cleanup_tasks" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskName" name="test_total_task_count" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionResponse" name="test_minimal_response" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionResponse" name="test_full_response" time="0.000" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_delete_bucket_with_force" time="0.035" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionDetailResponse" name="test_inherits_base_fields" time="0.000" /><testcase classname="tests.unit.test_middleware.test_correlation_id.TestCorrelationIDIntegration" name="test_correlation_id_persists_across_error" time="0.005" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_response_size" time="0.006" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionDetailResponse" name="test_success_with_return_value" time="0.000" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetPipeline" name="test_get_pipeline_success" time="0.020" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionDetailResponse" name="test_failure_with_error_info" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionDetailResponse" name="test_task_args_and_kwargs" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskExecutionDetailResponse" name="test_labels_and_metadata" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestRunningTaskResponse" name="test_required_fields" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestRunningTaskResponse" name="test_with_worker_id" time="0.000" /><testcase classname="tests.unit.test_middleware.test_debug" name="test_debug_middleware_adds_trace_headers" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_default_values" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_missing_client_info" time="0.006" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_with_filters" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_date_range_filters" time="0.000" /><testcase classname="tests.unit.test_middleware.test_debug" name="test_debug_middleware_respects_existing_trace_id" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_ordering_options" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_limit_bounds" time="0.001" /><testcase classname="tests.unit.test_middleware.test_debug" name="test_debug_middleware_short_circuits_when_disabled" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchParams" name="test_offset_non_negative" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_none_values" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchResponse" name="test_empty_results" time="0.000" /><testcase classname="tests.unit.test_middleware.test_i18n" name="test_i18n_prefers_user_and_sets_headers_and_cookie" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskSearchResponse" name="test_with_results" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_empty_strings" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskStatsResponse" name="test_default_values" time="0.000" /><testcase classname="tests.unit.test_middleware.test_i18n" name="test_i18n_uses_accept_language_fallback" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTaskStatsResponse" name="test_full_stats" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_list_of_strings" time="0.002" /><testcase classname="tests.unit.test_middleware.test_metrics" name="test_metrics_middleware_records_metrics" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestScheduledJobResponse" name="test_minimal_job" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestScheduledJobResponse" name="test_full_job" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestScheduledJobListResponse" name="test_empty_list" time="0.000" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetPipeline" name="test_get_pipeline_not_found" time="0.021" /><testcase classname="tests.unit.test_middleware.test_metrics_middleware" name="test_metrics_record_without_trace" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestScheduledJobListResponse" name="test_with_jobs" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTriggerTaskRequest" name="test_minimal_request" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_exception_during_request" time="0.009" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTriggerTaskRequest" name="test_with_params" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTriggerTaskRequest" name="test_all_task_names_valid" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTriggerTaskRequest" name="test_invalid_task_name" time="0.000" /><testcase classname="tests.unit.test_middleware.test_metrics_middleware" name="test_metrics_include_exemplar_when_trace_present" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestTriggerTaskResponse" name="test_response_fields" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestCancelTaskRequest" name="test_minimal_request" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestCancelTaskRequest" name="test_with_reason" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_initialization" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestCancelTaskRequest" name="test_reason_max_length" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestCancelTaskResponse" name="test_successful_cancellation" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_add_execution" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_schemas.TestCancelTaskResponse" name="test_failed_cancellation" time="0.000" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_list_buckets_success" time="0.034" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_total_time" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestTaskManagementServiceInit" name="test_init_with_tracker" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_average_time" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_request_with_body" time="0.007" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_average_time_zero_count" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestTaskManagementServiceInit" name="test_init_with_scheduler" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestTaskManagementServiceInit" name="test_init_without_tracker_uses_global" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_is_potential_n_plus_one_true" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_is_potential_n_plus_one_false_low_count" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryPattern" name="test_is_potential_n_plus_one_false_slow_execution" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_empty_query" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestSearchTasks" name="test_search_with_defaults" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_lowercase_conversion" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_whitespace_removal" time="0.000" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_response_with_body" time="0.006" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_numbers_replaced" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestSearchTasks" name="test_search_with_filters" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_single_quoted_strings" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_double_quoted_strings" time="0.000" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestSearchTasks" name="test_search_falls_back_when_count_fails" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_in_clause" time="0.000" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestExecutePipeline" name="test_execute_pipeline_sync_success" time="0.034" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_postgresql_parameters" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestSearchTasks" name="test_search_with_disconnected_tracker" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_exempts_health_paths" time="0.006" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_normalize_named_parameters" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestSearchTasks" name="test_search_with_no_tracker" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_select" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_update" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_custom_patterns" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_delete" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_insert" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetTaskDetails" name="test_get_existing_task" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_custom_sensitive_fields" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_not_found" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestQueryNormalizer" name="test_extract_table_name_case_insensitive" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetTaskDetails" name="test_get_nonexistent_task" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_preserves_domain_in_email" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_initialization" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetTaskDetails" name="test_get_task_with_error_details" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_initialization_default_exclude_patterns" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_preserves_last_4_in_phone" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_initialization_custom_exclude_patterns" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetRunningTasks" name="test_get_running_tasks" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_preserves_last_4_in_credit_card" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_dispatch_normal_request" time="0.005" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetRunningTasks" name="test_no_running_tasks" time="0.002" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_get_bucket_info_success" time="0.035" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetStats" name="test_get_stats" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_correlation_id" time="0.007" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetStats" name="test_stats_with_disconnected_tracker" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_record_query_basic" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestCancelTask" name="test_cancel_running_task" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_record_query_pattern_tracking" time="0.006" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestCancelTask" name="test_cancel_nonexistent_task" time="0.005" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_tenant_context" time="0.010" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestExecutePipeline" name="test_execute_pipeline_async_success" time="0.032" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_record_query_excluded_pattern" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestCancelTask" name="test_cancel_completed_task" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_handles_deeply_nested_dicts" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_get_scheduled_jobs" time="0.001" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_pii_masker_truncates_at_max_depth" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_get_scheduled_job" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_record_query_slow_query_logging" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_get_nonexistent_job" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_pause_job" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_record_query_no_state" time="0.003" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_handles_missing_content_type" time="0.005" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_resume_job" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_analyze_query_patterns_with_n_plus_one" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestScheduledJobs" name="test_no_scheduler" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestTriggerTask" name="test_trigger_task_no_broker" time="0.002" /><testcase classname="tests.unit.test_middleware.test_request_logging.TestRequestLoggingMiddleware" name="test_middleware_logs_different_log_levels" time="0.005" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_analyze_query_patterns_with_exception" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetTaskService" name="test_creates_service" time="0.001" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestBucketEndpoints" name="test_get_bucket_info_not_found" time="0.032" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestGetTaskService" name="test_handles_missing_scheduler" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_hsts_header_present" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestExceptions" name="test_broker_not_configured_error" time="0.000" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_log_n_plus_one_patterns" time="0.004" /><testcase classname="tests.unit.test_features.test_tasks.test_service.TestExceptions" name="test_tracker_not_available_error" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_hsts_disabled_in_debug_mode" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_search_tasks_handles_tracker_results" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_log_request_summary_with_n_plus_one" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_search_tasks_returns_empty_when_tracker_unavailable" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_csp_header_present" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_task_details_none_when_missing" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestNPlusOneDetectionMiddleware" name="test_log_request_summary_without_n_plus_one" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_running_tasks_maps_response" time="0.001" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestExecutePipeline" name="test_execute_pipeline_not_found" time="0.031" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestSetupNPlusOneMonitoring" name="test_setup_monitoring_without_sqlalchemy" time="0.000"><skipped type="pytest.skip" message="Requires SQLAlchemy engine setup">/home/administrator/Code/fastapi-template/tests/unit/test_middleware/test_n_plus_one_detection.py:459: Requires SQLAlchemy engine setup</skipped></testcase><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_x_frame_options_header" time="0.003" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestSetupNPlusOneMonitoring" name="test_setup_monitoring_context_function" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_stats_defaults_when_tracker_missing" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_cancel_task_success_and_message" time="0.001" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestIntegration" name="test_full_request_lifecycle" time="0.004" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_x_content_type_options_header" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_trigger_task_requires_broker" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_dlq_entries_returns_empty_when_no_middleware" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_x_xss_protection_header" time="0.002" /><testcase classname="tests.unit.test_middleware.test_n_plus_one_detection.TestIntegration" name="test_performance_overhead" time="0.121" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_dlq_entries_returns_entries" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_dlq_entry_not_found" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_referrer_policy_header" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_discard_dlq_task_success" time="0.001" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_list_objects_success" time="0.025" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_bulk_cancel_tasks_partial_success" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_permissions_policy_header" time="0.002" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_bulk_cancel_empty_list" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_task_progress_returns_none_when_no_middleware" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_x_permitted_cross_domain_policies_header" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_task_progress_returns_progress" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_x_powered_by_removed" time="0.003" /><testcase classname="tests.unit.test_features.test_tasks_service" name="test_get_task_progress_not_found" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAggregationPeriod" name="test_period_values" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_custom_csp_directives" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestUsageMetrics" name="test_create_usage_metrics" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestUsageMetrics" name="test_usage_metrics_to_dict" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_custom_frame_options" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestUsageMetrics" name="test_default_values" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentMetrics" name="test_create_agent_metrics" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_custom_permissions_policy" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentMetrics" name="test_default_values" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestCostAnalysis" name="test_create_cost_analysis" time="0.000" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestExecutePipeline" name="test_execute_pipeline_budget_exceeded" time="0.025" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestCostAnalysis" name="test_default_values" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_hsts_with_preload" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestErrorAnalysis" name="test_create_error_analysis" time="0.000" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestUsageReport" name="test_create_usage_report" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_hsts_without_subdomains" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestUsageReport" name="test_usage_report_to_dict" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestBenchmarkResult" name="test_create_benchmark_result" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_custom_hsts_max_age" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_get_usage_metrics" time="0.004" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_disable_individual_headers" time="0.002" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_list_objects_with_pagination" time="0.028" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_handles_non_http_scope" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_get_usage_metrics_with_agent_filter" time="0.003" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_all_default_headers_present" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_get_agent_metrics" time="0.010" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_custom_referrer_policy" time="0.003" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_csp_with_multiple_directives" time="0.002" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_permissions_policy_format" time="0.003" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetExecution" name="test_get_execution_success" time="0.023" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_headers_applied_to_all_responses" time="0.003" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_get_cost_analysis" time="0.004" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestSecurityHeadersMiddleware" name="test_performance_with_pure_asgi" time="0.039" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_generate_recommendations_high_error_rate" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalytics" name="test_generate_recommendations_high_wasted_cost" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestPerformanceBenchmark" name="test_run_benchmark" time="0.003" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_upload_object_success" time="0.033" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestPerformanceBenchmark" name="test_benchmark_with_failures" time="0.002" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestPerformanceBenchmark" name="test_format_results" time="0.001" /><testcase classname="tests.unit.test_infra.test_ai.test_agents.test_analytics.TestAgentAnalyticsIntegration" name="test_get_usage_report" time="0.006" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetExecution" name="test_get_execution_not_found" time="0.024" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_upload_object_with_acl" time="0.025" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnvironmentAwareFeatures" name="test_production_environment_enables_stricter_csp" time="0.003" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnvironmentAwareFeatures" name="test_development_environment_allows_relaxed_csp" time="0.003" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetProgress" name="test_get_progress_success" time="0.027"><failure message="AssertionError: assert 'running' == 'processing'&#10;  &#10;  #x1B[0m#x1B[91m- processing#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ running#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">tests/unit/test_features/test_ai/test_pipeline_router.py:419: in test_get_progress_success
    assert data["status"] == "processing"
E   AssertionError: assert 'running' == 'processing'
E     
E     #x1B[0m#x1B[91m- processing#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E     #x1B[92m+ running#x1B[39;49;00m#x1B[90m#x1B[39;49;00m</failure></testcase><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnvironmentAwareFeatures" name="test_production_auto_enables_hsts" time="0.002" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnvironmentAwareFeatures" name="test_environment_parameter_works" time="0.004" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestServerHeaderHandling" name="test_server_header_removed_when_none" time="0.003" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestServerHeaderHandling" name="test_server_header_kept_when_false" time="0.002" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestServerHeaderHandling" name="test_server_header_custom_value" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_email_preserves_domain" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnhancedPermissionsPolicy" name="test_enhanced_permissions_policy_includes_all_features" time="0.002" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_download_object_success" time="0.035" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_email_without_domain_preservation" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_email_short_local_part" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestEnhancedPermissionsPolicy" name="test_fullscreen_allowed_for_self" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_email_invalid_format" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_phone_preserves_last_4" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestCSPEnhancements" name="test_csp_handles_valueless_directives" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_phone_without_last_4_preservation" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_phone_various_formats" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_credit_card_preserves_last_4" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestCSPEnhancements" name="test_production_csp_includes_upgrade_insecure_requests" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_credit_card_without_separators" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_basic" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_with_hsts" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_string_with_email" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_string_with_phone" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_with_csp" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_with_custom_csp" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_string_with_credit_card" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_with_valueless_directive" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_string_with_ssn" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestGetSecurityHeadersHelper" name="test_get_security_headers_in_error_handler" time="0.003" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_string_with_multiple_patterns" time="0.001" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestGetProgress" name="test_get_progress_not_found" time="0.026" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_dict_sensitive_fields" time="0.001" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestBackwardCompatibility" name="test_default_behavior_unchanged" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_dict_nested_structure" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_dict_with_lists" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_dict_max_depth_limit" time="0.000" /><testcase classname="tests.unit.test_middleware.test_security_headers.TestBackwardCompatibility" name="test_legacy_parameters_still_work" time="0.002" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_dict_preserves_non_string_values" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_custom_mask_character" time="0.000" /><testcase classname="tests.unit.test_middleware.test_size_limit" name="test_size_limit_blocks_large_requests" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_custom_sensitive_fields" time="0.000" /><testcase classname="tests.unit.test_middleware.test_size_limit" name="test_size_limit_passes_through_when_within_limit" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_custom_patterns" time="0.001" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_get_tenant_context_returns_none_when_not_set" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_case_insensitive_field_matching" time="0.001" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_set_and_get_tenant_context" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_empty_values" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_mask_authorization_headers" time="0.000" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_clear_tenant_context" time="0.001" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_complex_real_world_data" time="0.001" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_require_tenant_raises_when_not_set" time="0.000" /><testcase classname="tests.unit.test_middleware.test_pii_masking.TestPIIMasker" name="test_list_of_dicts" time="0.001" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_require_tenant_returns_context_when_set" time="0.000" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_tenant_context_is_frozen" time="0.000" /><testcase classname="tests.unit.test_middleware.test_tenant.TestTenantContextFunctions" name="test_context_isolation_between_calls" time="0.001" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_download_object_not_found" time="0.031" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestBudgetEndpoints" name="test_set_budget_success" time="0.021" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestBudgetEndpoints" name="test_get_budget_status_success" time="0.024" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestObjectEndpoints" name="test_delete_object_success" time="0.029" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestBudgetEndpoints" name="test_get_spend_summary_success" time="0.021" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestACLEndpoints" name="test_set_object_acl_success" time="0.031" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestListCapabilities" name="test_list_capabilities_success" time="0.025" /><testcase classname="tests.unit.test_features.test_ai.test_pipeline_router.TestListProviders" name="test_list_providers_success" time="0.020" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestACLEndpoints" name="test_get_object_acl_success" time="0.031" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_repository_initialization" time="0.002" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_audit_repository_returns_singleton" time="0.001" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestSchemaValidation" name="test_bucket_create_validation" time="0.031" /><testcase classname="tests.unit.test_features.test_storage.test_router.TestSchemaValidation" name="test_object_list_query_validation" time="0.042" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_valid_tag" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_name_normalization" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_minimal_tag" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_invalid_color_format" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_valid_hex_colors" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_name_too_long" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagCreate" name="test_empty_name" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagUpdate" name="test_partial_update" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagUpdate" name="test_name_normalization" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagUpdate" name="test_empty_update" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagResponse" name="test_from_attributes" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagWithCountResponse" name="test_includes_count" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestTagWithCountResponse" name="test_default_count" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestReminderTagsUpdate" name="test_valid_tag_ids" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestReminderTagsUpdate" name="test_empty_list_allowed" time="0.000" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestAddTagsRequest" name="test_valid_request" time="0.000" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestAddTagsRequest" name="test_empty_list_rejected" time="0.000" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestRemoveTagsRequest" name="test_valid_request" time="0.001" /><testcase classname="tests.unit.test_features.test_tags.test_schemas.TestRemoveTagsRequest" name="test_empty_list_rejected" time="0.001" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_search_tasks_with_filters" time="0.030" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_search_tasks_invalid_params" time="0.019" /><testcase classname="tests.unit.test_features.test_tasks.test_router" name="test_get_running_tasks" time="0.020" /><testcase classname="tests.unit.test_infra.test_database_session" name="test_ensure_event_outbox_table_creates_table" time="15.302" /><testcase classname="tests.unit.test_infra.test_database_session" name="test_ensure_event_outbox_table_is_idempotent" time="0.013" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionInfo" name="test_connection_info_creation" time="0.001" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionInfo" name="test_connection_info_defaults" time="0.000" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_connect_accepts_websocket" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_connect_adds_to_channels" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_disconnect_removes_connection" time="0.003" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_disconnect_removes_from_channels" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_subscribe_adds_to_channel" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_unsubscribe_removes_from_channel" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_send_to_connection" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_send_to_nonexistent_connection" time="0.001" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_broadcast_local_only" time="0.004" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_broadcast_with_exclude" time="0.003" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_send_to_user" time="0.004" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_connection_count" time="0.006" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_channel_count" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_max_connections_enforcement" time="0.003" /><testcase classname="tests.unit.test_infra.test_realtime.TestConnectionManager" name="test_get_channel_connections" time="0.002" /><testcase classname="tests.unit.test_infra.test_realtime.TestWebSocketSchemas" name="test_connected_message" time="0.001" /><testcase classname="tests.unit.test_infra.test_realtime.TestWebSocketSchemas" name="test_broadcast_message" time="0.000" /><testcase classname="tests.unit.test_infra.test_realtime.TestWebSocketSchemas" name="test_error_message" time="0.000" /><testcase classname="tests.unit.test_infra.test_realtime.TestWebSocketSchemas" name="test_subscribe_message" time="0.001" /><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestBackendFactory" name="test_create_s3_backend" time="0.000"><skipped type="pytest.skip" message="aioboto3 not installed">/home/administrator/Code/fastapi-template/tests/unit/test_infra/test_storage/test_factory.py:21: aioboto3 not installed</skipped></testcase><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestBackendFactory" name="test_create_minio_backend" time="0.000"><skipped type="pytest.skip" message="aioboto3 not installed">/home/administrator/Code/fastapi-template/tests/unit/test_infra/test_storage/test_factory.py:39: aioboto3 not installed</skipped></testcase><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestBackendFactory" name="test_factory_rejects_unconfigured_storage" time="0.074" /><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestStorageBackendType" name="test_enum_values" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestStorageBackendType" name="test_enum_is_string" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_factory.TestStorageBackendType" name="test_enum_comparison" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestTenantContext" name="test_create_tenant_context" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestTenantContext" name="test_tenant_context_immutable" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestTenantContext" name="test_tenant_context_default_metadata" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestTenantContext" name="test_tenant_context_equality" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestTenantContext" name="test_tenant_context_hash" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestObjectMetadata" name="test_create_object_metadata" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestObjectMetadata" name="test_object_metadata_immutable" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestObjectMetadata" name="test_object_metadata_optional_fields" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestUploadResult" name="test_create_upload_result" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestUploadResult" name="test_upload_result_immutable" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestUploadResult" name="test_upload_result_optional_version" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestBucketInfo" name="test_create_bucket_info" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestBucketInfo" name="test_bucket_info_immutable" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestBucketInfo" name="test_bucket_info_default_versioning" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_protocol.TestBucketInfo" name="test_bucket_info_optional_fields" time="0.000" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_explicit_bucket_takes_priority" time="0.071" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_tenant_bucket_with_multi_tenancy_enabled" time="0.071" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_tenant_bucket_with_uuid_pattern" time="0.074" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_fallback_to_shared_bucket" time="0.076" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_fallback_to_default_bucket_when_no_shared" time="0.074" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_single_tenant_mode_uses_default_bucket" time="0.071" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_require_tenant_context_raises_when_missing" time="0.071" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestBucketResolution" name="test_require_tenant_context_allows_explicit_bucket" time="0.073" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceProperties" name="test_is_ready_when_not_initialized" time="0.076" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceProperties" name="test_backend_name_when_not_initialized" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceProperties" name="test_settings_property" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_startup_skipped_when_not_configured" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_startup_creates_backend" time="0.119" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_shutdown_when_not_initialized" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_shutdown_calls_backend_shutdown" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_health_check_when_not_ready" time="0.072" /><testcase classname="tests.unit.test_infra.test_storage.test_service.TestStorageServiceLifecycle" name="test_health_check_delegates_to_backend" time="0.072" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_create_tracker_returns_redis" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_create_tracker_returns_postgres" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_get_tracker_returns_global" time="0.000" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_start_tracker_skips_when_disabled" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_start_tracker_initializes_global" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_factory" name="test_stop_tracker_disconnects" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_connect_and_disconnect" time="0.002" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_on_task_start_creates_execution_record" time="0.059" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_on_task_finish_updates_record" time="0.003" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_get_running_tasks_queries_running" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_get_task_history_returns_list" time="0.001" /><testcase classname="tests.unit.test_infra.test_tracking.test_postgres_tracker" name="test_count_task_history" time="0.855" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_response_structure" time="17.852" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_key_found" time="19.390" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_create_audit_log" time="19.309" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_custom_order_by" time="2.878" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_key_not_found" time="2.835" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_audit_log" time="2.884" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_invalid_order_by_falls_back_to_timestamp" time="2.889" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_by_status" time="2.875" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_entity_type" time="2.872" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_empty" time="2.831" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_by_enabled" time="2.901" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_entity_id" time="2.906" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_multiple_updates" time="3.063" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_pagination" time="3.051" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_user_id" time="2.970" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_no_logs" time="2.851"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...&#10;                                ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:804: in test_get_summary_with_no_logs
    summary = await service.get_summary()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_keys" time="2.792" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_tenant_id" time="2.815" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_only_failed_logs" time="2.859"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...&#10;                                ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:827: in test_get_summary_with_only_failed_logs
    summary = await service.get_summary()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_keys_empty_list" time="2.778" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_action" time="2.836" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_mixed_success" time="2.980"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...&#10;                                ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:855: in test_get_summary_with_mixed_success
    summary = await service.get_summary()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_all" time="2.840" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_multiple_actions" time="2.807" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_delete_old_logs_no_matching_logs" time="2.870" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_key_found" time="2.842" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_success_status" time="2.844" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_audit_service_helper" time="2.828" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_key_not_found" time="2.808" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_override_repository_initialization" time="0.001" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_request_id" time="2.899" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_with_minimal_fields" time="2.909" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_entity_found" time="2.843" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_by_time_range" time="3.102" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_with_none_values" time="3.646" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_entity_not_found" time="3.617" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_pagination" time="3.502" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_has_more_calculation" time="2.920" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_upsert_creates_new" time="2.835" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_ordering" time="2.835" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_all_filters_combined" time="2.957" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_upsert_updates_existing" time="2.961" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_entity_history" time="2.934" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_with_complex_changes" time="2.817" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_by_flag_key" time="2.827" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_entity_history_respects_limit" time="2.823" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_empty_result" time="2.849" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_by_entity_type" time="2.845" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_summary_stats" time="2.896" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_offset_beyond_total" time="2.835" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_list_with_filters_by_entity_id" time="2.867" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_get_summary_stats_with_time_filter" time="2.888" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_with_only_create" time="2.896" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_context_user_only" time="2.879" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_delete_before" time="2.916" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_with_delete_action" time="2.843" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_context_tenant_only" time="2.829" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_delete_before_with_tenant_filter" time="2.893" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_tenant_filter" time="2.909"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...&#10;                                 ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'tenant-123'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:1138: in test_get_summary_with_tenant_filter
    summary = await service.get_summary(tenant_id="tenant-123")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'tenant-123'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_context_user_precedence" time="2.828" /><testcase classname="tests.unit.test_features.test_audit.test_repository" name="test_query_logs_with_all_filters" time="2.812" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_empty_actions" time="3.699"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...&#10;                                 ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR AND audit_logs.timestamp &gt;= %(timestamp_1)s::TIMESTAMP WITH TIME ZONE]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'nonexistent-tenant', 'timestamp_1': datetime.datetime(2025, 12, 11, 19, 33, 45, 346503, tzinfo=datetime.timezone.utc)}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:1146: in test_get_summary_with_empty_actions
    summary = await service.get_summary(
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR AND audit_logs.timestamp &gt;= %(timestamp_1)s::TIMESTAMP WITH TIME ZONE]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'nonexistent-tenant', 'timestamp_1': datetime.datetime(2025, 12, 11, 19, 33, 45, 346503, tzinfo=datetime.timezone.utc)}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_context_no_context" time="2.811" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_service_initialization" time="2.750" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_get_by_context_multiple_flags" time="2.848" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_audit_service_with_session" time="2.753" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_entity_found" time="3.282" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_creates_audit_entry" time="3.276" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_entity_not_found" time="2.723" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_computes_changes" time="2.734" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_flag" time="2.638" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_with_all_fields" time="2.653" /><testcase classname="tests.unit.test_features.test_featureflags.test_repository" name="test_delete_by_flag_no_matches" time="2.682" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_feature_flags_is_enabled_and_get_all_uses_service" time="0.002" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_get_feature_flags_builds_context" time="0.001"><failure message="KeyError: 'roles'">tests/unit/test_features/test_featureflags.py:110: in test_get_feature_flags_builds_context
    assert flags.attributes["roles"] == ["admin"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'roles'</failure></testcase><testcase classname="tests.unit.test_features.test_featureflags" name="test_require_feature_blocks_when_disabled" time="0.001" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_compare_operator_variations" time="0.000" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_matches_rule_handles_user_tenant_and_attributes" time="0.000" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_evaluate_flag_paths_cover_override_and_time_and_status" time="0.001" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_percentage_based_evaluation" time="0.000" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_targeted_rule_matching" time="0.000" /><testcase classname="tests.unit.test_features.test_featureflags" name="test_get_percentage_bucket_is_consistent" time="0.000" /><testcase classname="tests.unit.test_features.test_graphql.test_playground" name="test_playground_route_serves_html_and_assets" time="0.020" /><testcase classname="tests.unit.test_features.test_graphql.test_playground" name="test_playground_route_respects_root_path_and_subscriptions_flag" time="0.005" /><testcase classname="tests.unit.test_features.test_health.test_accent_auth_provider.TestAccentAuthHealthProvider" name="test_healthy_status_fast_response" time="0.002"><failure message="AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'">tests/unit/test_features/test_health/test_accent_auth_provider.py:21: in test_healthy_status_fast_response
    with patch(
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'</failure></testcase><testcase classname="tests.unit.test_features.test_health.test_accent_auth_provider.TestAccentAuthHealthProvider" name="test_degraded_status_slow_response" time="0.002"><failure message="AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'">tests/unit/test_features/test_health/test_accent_auth_provider.py:52: in test_degraded_status_slow_response
    with patch(
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'</failure></testcase><testcase classname="tests.unit.test_features.test_health.test_accent_auth_provider.TestAccentAuthHealthProvider" name="test_unhealthy_status_connection_error" time="0.001"><failure message="AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'">tests/unit/test_features/test_health/test_accent_auth_provider.py:82: in test_unhealthy_status_connection_error
    with patch(
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'</failure></testcase><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_with_error" time="2.458" /><testcase classname="tests.unit.test_features.test_health.test_accent_auth_provider.TestAccentAuthHealthProvider" name="test_unhealthy_status_timeout" time="0.820"><failure message="AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'">tests/unit/test_features/test_health/test_accent_auth_provider.py:108: in test_unhealthy_status_timeout
    with patch(
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../.local/share/uv/python/cpython-3.13.8-linux-x86_64-gnu/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'example_service.features.health' has no attribute 'accent_auth_provider'</failure></testcase><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_log_from_schema" time="2.067" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_by_id_found" time="1.811" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_by_id_not_found" time="1.795" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_with_filters" time="1.983" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_pagination" time="1.846" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_ordering" time="1.803" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_by_action" time="1.723" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_by_multiple_actions" time="1.794" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_query_by_time_range" time="1.754" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history" time="1.769" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_respects_limit" time="1.766" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_entity_history_without_create_action" time="1.693" /><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary" time="1.796"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...&#10;                                 ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'tenant-123'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:527: in test_get_summary
    summary = await service.get_summary(tenant_id="tenant-123")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.tenant_id = %(tenant_id_1)s::VARCHAR]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'tenant_id_1': 'tenant-123'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_with_time_filter" time="1.752"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...&#10;                                 ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.timestamp &gt;= %(timestamp_1)s::TIMESTAMP WITH TIME ZONE AND audit_logs.timestamp &lt;= %(timestamp_2)s::TIMESTAMP WITH TIME ZONE]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'timestamp_1': datetime.datetime(2025, 12, 10, 16, 34, 25, 702328, tzinfo=datetime.timezone.utc), 'timestamp_2': datetime.datetime(2025, 12, 10, 19, 34, 25, 702328, tzinfo=datetime.timezone.utc)}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:571: in test_get_summary_with_time_filter
    summary = await service.get_summary(
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE (audit_logs.action LIKE $1 OR audit_logs.action LIKE $...
E                                    ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE (audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s) AND audit_logs.timestamp &gt;= %(timestamp_1)s::TIMESTAMP WITH TIME ZONE AND audit_logs.timestamp &lt;= %(timestamp_2)s::TIMESTAMP WITH TIME ZONE]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge', 'timestamp_1': datetime.datetime(2025, 12, 10, 16, 34, 25, 702328, tzinfo=datetime.timezone.utc), 'timestamp_2': datetime.datetime(2025, 12, 10, 19, 34, 25, 702328, tzinfo=datetime.timezone.utc)}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase><testcase classname="tests.unit.test_features.test_audit.test_service" name="test_get_summary_empty" time="2.602"><failure message="sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown&#10;LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...&#10;                                ^&#10;HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.&#10;[SQL: SELECT count(audit_logs.id) AS count_1 &#10;FROM audit_logs &#10;WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]&#10;[parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]&#10;(Background on this error at: https://sqlalche.me/e/20/f405)">.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UndefinedFunction: operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

The above exception was the direct cause of the following exception:
tests/unit/test_features/test_audit/test_service.py:582: in test_get_summary_empty
    summary = await service.get_summary()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
example_service/features/audit/service.py:464: in get_summary
    dangerous_count = await self._count_dangerous_actions(
example_service/features/audit/service.py:503: in _count_dangerous_actions
    result = await self.session.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:449: in execute
    result = await greenlet_spawn(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2351: in execute
    return self._execute_internal(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2249: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
    result = conn.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/psycopg.py:597: in execute
    result = self.await_(self._cursor.execute(query, params, **kw))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/psycopg/cursor_async.py:97: in execute
    raise ex.with_traceback(None)
E   sqlalchemy.exc.ProgrammingError: (psycopg.errors.UndefinedFunction) operator does not exist: auditaction ~~ unknown
E   LINE 3: WHERE audit_logs.action LIKE $1 OR audit_logs.action LIKE $2...
E                                   ^
E   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
E   [SQL: SELECT count(audit_logs.id) AS count_1 
E   FROM audit_logs 
E   WHERE audit_logs.action LIKE %(action_1)s OR audit_logs.action LIKE %(action_2)s OR audit_logs.action LIKE %(action_3)s OR audit_logs.action LIKE %(action_4)s OR audit_logs.action = %(action_5)s OR audit_logs.action = %(action_6)s OR audit_logs.action = %(action_7)s]
E   [parameters: {'action_1': '%.deleted', 'action_2': '%.revoked', 'action_3': '%.suspended', 'action_4': '%.disconnected', 'action_5': 'delete', 'action_6': 'bulk_delete', 'action_7': 'purge'}]
E   (Background on this error at: https://sqlalche.me/e/20/f405)</failure></testcase></testsuite></testsuites>